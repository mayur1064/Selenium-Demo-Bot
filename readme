# Use Alpine-based JDK image
FROM openjdk:17-jdk-alpine

WORKDIR /opt/app

# Install curl using apk
RUN apk add --no-cache curl

# Copy your application JAR into the image
COPY target/myapp.jar app.jar

# Download Application Insights agent JAR
RUN curl -L -o applicationinsights-agent.jar <URL_TO_AI_AGENT_JAR>

# Expose application port
EXPOSE 8080

# Run the app with Application Insights agent
ENTRYPOINT ["java", "-javaagent:/opt/app/applicationinsights-agent.jar", "-jar", "app.jar"]
